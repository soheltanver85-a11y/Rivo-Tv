<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live TV Pro - Ultimate Edition</title>
    <link href="https://vjs.zencdn.net/7.20.3/video-js.css" rel="stylesheet" />
    <style>
        :root { --accent: #ff0055; --bg: #000; }
        body, html { margin: 0; padding: 0; background: var(--bg); color: white; font-family: 'Roboto', sans-serif; overflow: hidden; height: 100%; }

        .video-wrapper { width: 100%; height: 60vh; background: #000; position: relative; }
        .video-js { width: 100% !important; height: 100% !important; }

        .list-container { height: 40vh; padding: 20px; overflow-y: auto; }
        .channel-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap: 20px; }

        .tv-card {
            background: #111; border-radius: 15px; padding: 15px; text-align: center;
            cursor: pointer; border: 3px solid transparent; outline: none;
            transition: 0.2s ease-in-out;
        }
        .tv-card:focus { transform: scale(1.1); border-color: var(--accent); box-shadow: 0 0 20px var(--accent); }

        .logo-circle { width: 80px; height: 80px; background: #fff; border-radius: 50%; margin: 0 auto 10px; display: flex; align-items: center; justify-content: center; overflow: hidden; }
        .logo-circle img { width: 75%; height: auto; }
        .name-text { font-size: 14px; color: #ddd; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

        /* ‡¶Ö‡¶®-‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶® ‡¶®‡ßã‡¶ü‡¶ø‡¶´‡¶ø‡¶ï‡ßá‡¶∂‡¶® (‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‡¶ì ‡¶≠‡¶≤‡¶ø‡¶â‡¶Æ) */
        .status-overlay {
            position: absolute; top: 20px; left: 20px; background: rgba(0,0,0,0.8);
            padding: 10px 20px; border-radius: 8px; display: none; z-index: 10;
            border-left: 5px solid var(--accent); font-weight: bold;
        }
    </style>
</head>
<body>

    <div class="video-wrapper">
        <div id="status-info" class="status-overlay"></div>
        <video id="tv-player" class="video-js vjs-big-play-centered" controls autoplay preload="auto"></video>
    </div>

    <div class="list-container">
        <div class="channel-grid" id="main-grid">
            <div style="padding: 20px;">‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</div>
        </div>
    </div>

    <script src="https://vjs.zencdn.net/7.20.3/video.min.js"></script>
    <script>
        const m3uUrl = 'https://raw.githubusercontent.com/soheltanver85-a11y/Live-tv2/refs/heads/main/Live-tv2';
        const player = videojs('tv-player');
        let channels = [];
        let currentIndex = 0;

        async function initApp() {
            try {
                const res = await fetch(m3uUrl);
                const text = await res.text();
                const lines = text.split('\n');
                let tempName = '', tempLogo = '';

                lines.forEach(line => {
                    if (line.startsWith('#EXTINF')) {
                        tempName = line.split(',')[1] || 'Unknown';
                        const logoMatch = line.match(/tvg-logo="(.*?)"/);
                        tempLogo = logoMatch ? logoMatch[1] : '';
                    } else if (line.startsWith('http')) {
                        channels.push({ name: tempName, logo: tempLogo, url: line.trim() });
                    }
                });
                renderGrid();
                if(channels.length > 0) playChannel(0);
            } catch (e) { console.error("Update Error!"); }
        }

        function renderGrid() {
            const grid = document.getElementById('main-grid');
            grid.innerHTML = channels.map((ch, i) => `
                <div class="tv-card" tabindex="0" id="ch-${i}" onclick="playChannel(${i})">
                    <div class="logo-circle"><img src="${ch.logo}" onerror="this.src='https://via.placeholder.com/100?text=TV'"></div>
                    <div class="name-text">${ch.name}</div>
                </div>
            `).join('');
        }

        function showStatus(text) {
            const statusBox = document.getElementById('status-info');
            statusBox.innerText = text;
            statusBox.style.display = 'block';
            clearTimeout(window.statusTimeout);
            window.statusTimeout = setTimeout(() => statusBox.style.display = 'none', 3000);
        }

        function playChannel(index) {
            if(index < 0) index = channels.length - 1;
            if(index >= channels.length) index = 0;
            currentIndex = index;
            const ch = channels[currentIndex];
            player.src({ src: ch.url, type: 'application/x-mpegURL' });
            player.play();
            showStatus("üì∫ " + ch.name);
            const el = document.getElementById(`ch-${index}`);
            if(el) el.focus();
        }

        // ‡¶∞‡¶ø‡¶Æ‡ßã‡¶ü ‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤ ‡¶π‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶°‡¶≤‡¶æ‡¶∞
        document.addEventListener('keydown', (e) => {
            if (e.keyCode === 39) { // Right - Next Channel
                playChannel(currentIndex + 1);
            } else if (e.keyCode === 37) { // Left - Previous Channel
                playChannel(currentIndex - 1);
            } else if (e.keyCode === 38) { // Up - Volume Up
                e.preventDefault();
                let vol = player.volume();
                player.volume(Math.min(vol + 0.1, 1));
                showStatus("üîä Volume: " + Math.round(player.volume() * 100) + "%");
            } else if (e.keyCode === 40) { // Down - Volume Down
                e.preventDefault();
                let vol = player.volume();
                player.volume(Math.max(vol - 0.1, 0));
                showStatus("üîâ Volume: " + Math.round(player.volume() * 100) + "%");
            } else if (e.keyCode === 13) { // OK - Play/Pause
                if (player.paused()) player.play(); else player.pause();
            }
        });

        initApp();
    </script>
</body>
</html>
